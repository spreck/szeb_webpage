// script.js



var cityBoundingBoxes = {"Adelanto":{"minx":"-117.5429051657106","miny":"34.4702440564327","maxx":"-117.3017003348809","maxy":"34.70425763351037"},"Agoura Hills":{"minx":"-118.8208762852663","miny":"34.1038373653049","maxx":"-118.7009883216119","maxy":"34.18412279954419"},"Alameda":{"minx":"-122.3335387309781","miny":"37.71788791177878","maxx":"-122.1993654115677","maxy":"37.81538885110799"},"Albany":{"minx":"-122.3268655939056","miny":"37.86374850630053","maxx":"-122.2620000138162","maxy":"37.91558602856166"},"Alhambra":{"minx":"-118.1877218962862","miny":"34.04226223535169","maxx":"-118.0869789458329","maxy":"34.12868099302763"},"Aliso Viejo":{"minx":"-117.766761220763","miny":"33.52910208818783","maxx":"-117.6808713686225","maxy":"33.63002920143404"},"Alturas":{"minx":"-120.599846008024","miny":"41.46131237221679","maxx":"-120.5057811142826","maxy":"41.52058464435591"},"Amador City":{"minx":"-120.8545524014868","miny":"38.39707776168433","maxx":"-120.7936920735693","maxy":"38.43818847913239"},"American Canyon":{"minx":"-122.298146042564","miny":"38.13560645593963","maxx":"-122.2030793143359","maxy":"38.22391235347047"},"Anaheim":{"minx":"-118.0546288200342","miny":"33.75448137212368","maxx":"-117.632376148209","maxy":"33.90728852611998"},"Anderson":{"minx":"-122.3464978493257","miny":"40.39274863060207","maxx":"-122.2346320447866","maxy":"40.4912069643301"},"Angels Camp":{"minx":"-120.5893370728433","miny":"38.02066191177661","maxx":"-120.5091979526111","maxy":"38.10536810096819"},"Antioch":{"minx":"-121.8972425713479","miny":"37.89598472772079","maxx":"-121.7042600581477","maxy":"38.04548334884596"},"Apple Valley":{"minx":"-117.3247313819281","miny":"34.37970055326221","maxx":"-117.1029742039669","maxy":"34.69878398365234"},"Arcadia":{"minx":"-118.089470534635","miny":"34.06142400014481","maxx":"-117.9719385281141","maxy":"34.19553048488167"},"Arcata":{"minx":"-124.1350754644467","miny":"40.80946585206903","maxx":"-124.0276361284883","maxy":"40.92565404483032"},"Arroyo Grande":{"minx":"-120.6300078314001","miny":"35.08371323444711","maxx":"-120.5243819357605","maxy":"35.16688251733153"},"Artesia":{"minx":"-118.1213551105001","miny":"33.83434776915555","maxx":"-118.0480936225585","maxy":"33.89677447807507"},"Arvin":{"minx":"-118.8781917138253","miny":"35.1508982121261","maxx":"-118.7789273602787","maxy":"35.2382898113146"},"Atascadero":{"minx":"-120.780540818468","miny":"35.42091018192674","maxx":"-120.6084572336722","maxy":"35.55877731091327"},"Atherton":{"minx":"-122.2582370647338","miny":"37.41052021487643","maxx":"-122.1461438951138","maxy":"37.48791813329297"},"Atwater":{"minx":"-120.654244254834","miny":"37.31648954132834","maxx":"-120.5404984110058","maxy":"37.38956658991119"},"Auburn":{"minx":"-121.1390755454324","miny":"38.84247449021632","maxx":"-121.015719183292","maxy":"38.973806850267"},"Avalon":{"minx":"-118.3596398729657","miny":"33.32302244286757","maxx":"-118.3064024376313","maxy":"33.35603976144416"},"Avenal":{"minx":"-120.1820694651767","miny":"35.96385402366063","maxx":"-120.0304328409967","maxy":"36.11578391970158"},"Azusa":{"minx":"-117.9644984370599","miny":"34.0914325433607","maxx":"-117.8513322883348","maxy":"34.18418777695437"},"Bakersfield":{"minx":"-119.2698944675532","miny":"35.16022968019451","maxx":"-118.7147980370823","maxy":"35.49696309460225"},"Baldwin Park":{"minx":"-118.0267641642575","miny":"34.0366105083716","maxx":"-117.9218718999606","maxy":"34.1305533028251"},"Banning":{"minx":"-116.9733424007232","miny":"33.87253141510237","maxx":"-116.7893575637633","maxy":"34.03251189670869"},"Barstow":{"minx":"-117.1828264757243","miny":"34.80755154524046","maxx":"-116.8431476174725","maxy":"34.96533382844031"},"Beaumont":{"minx":"-117.127444213267","miny":"33.78424644952806","maxx":"-116.8521624939649","maxy":"33.99809063932217"},"Bell Gardens":{"minx":"-118.1960762033303","miny":"33.93465626004735","maxx":"-118.1113823804526","maxy":"33.99623606079093"},"Bellflower":{"minx":"-118.1727778716838","miny":"33.84872198740811","maxx":"-118.0871839412292","maxy":"33.92854670273402"},"Bell":{"minx":"-118.2253280948885","miny":"33.9454084437347","maxx":"-118.1329166042172","maxy":"34.01470845297241"},"Belmont":{"minx":"-122.3540895964122","miny":"37.47225240422308","maxx":"-122.2441108874267","maxy":"37.55209237224379"},"Belvedere":{"minx":"-122.4986226836629","miny":"37.86264981729808","maxx":"-122.4439225110697","maxy":"37.90332363199705"},"Benicia":{"minx":"-122.2251060242995","miny":"38.02607248707924","maxx":"-122.092120727587","maxy":"38.12410524584431"},"Berkeley":{"minx":"-122.3196212812999","miny":"37.82367693170659","maxx":"-122.208713377944","maxy":"37.92055376460802"},"Beverly Hills":{"minx":"-118.4469022512875","miny":"34.03571121912719","maxx":"-118.3524200566616","maxy":"34.12635658276474"},"Big Bear Lake":{"minx":"-116.9782465107338","miny":"34.22448906948975","maxx":"-116.8397993699541","maxy":"34.27417192285913"},"Biggs":{"minx":"-121.7259399638238","miny":"39.38128963636392","maxx":"-121.6785675544887","maxy":"39.4361440301419"},"Bishop":{"minx":"-118.4322483852881","miny":"37.33222997532457","maxx":"-118.3587596917135","maxy":"37.39443036870927"},"Blue Lake":{"minx":"-124.03808003654","miny":"40.85625182310169","maxx":"-123.9470050101024","maxy":"40.90408017458024"},"Blythe":{"minx":"-114.7273225885451","miny":"33.52307894881955","maxx":"-114.4711861150732","maxy":"33.69439504141273"},"Borrego Springs":{"minx":"-116.4151320734212","miny":"33.15729036106891","maxx":"-116.2444298505131","maxy":"33.35814083181419"},"Bradbury":{"minx":"-118.0034534062833","miny":"34.11715903198763","maxx":"-117.9323045110899","maxy":"34.17292793476231"},"Brawley":{"minx":"-115.5958161866372","miny":"32.92718749665026","maxx":"-115.4797164335523","maxy":"33.04460564819708"},"Brea":{"minx":"-117.9549235996587","miny":"33.88298843847139","maxx":"-117.7650354316316","maxy":"33.96794180218664"},"Brentwood":{"minx":"-121.7850823284886","miny":"37.87269904078759","maxx":"-121.6410494014306","maxy":"37.98737056647172"},"Brisbane":{"minx":"-122.4553029831244","miny":"37.65554237495652","maxx":"-122.3748206807942","maxy":"37.72504588562473"},"Buellton":{"minx":"-120.2306387463344","miny":"34.58766207413365","maxx":"-120.1541986338571","maxy":"34.65291358250521"},"Buena Park":{"minx":"-118.0608522357127","miny":"33.79289106229181","maxx":"-117.9536448800845","maxy":"33.91133999463253"},"Burbank":{"minx":"-118.3922296607116","miny":"34.12054266882424","maxx":"-118.2693792430252","maxy":"34.22246171930615"},"Burlingame":{"minx":"-122.4227305121909","miny":"37.55099793115279","maxx":"-122.3114599242291","maxy":"37.61490490907978"},"Butte County":{"minx":"-122.0469805174316","miny":"39.30495372358828","maxx":"-121.1209276209249","maxy":"40.12002954019349"},"Calabasas":{"minx":"-118.745021078457","miny":"34.08205653882939","maxx":"-118.5780440691801","maxy":"34.17793737578685"},"Calexico":{"minx":"-115.5588328144182","miny":"32.64730254417026","maxx":"-115.4308986437773","maxy":"32.73076530673419"},"California City":{"minx":"-118.1808372103969","miny":"35.01232209039771","maxx":"-117.6118373209185","maxy":"35.2535905821783"},"Calimesa":{"minx":"-117.1614525796563","miny":"33.93713695853081","maxx":"-116.9716179260076","maxy":"34.02665601708837"},"Calipatria":{"minx":"-115.5451656355709","miny":"33.09655591113594","maxx":"-115.4929620314031","maxy":"33.14760342544169"},"Calistoga":{"minx":"-122.6268608176142","miny":"38.54721768471958","maxx":"-122.5300835356795","maxy":"38.60896745017308"},"Camarillo":{"minx":"-119.1482150395176","miny":"34.16788823166141","maxx":"-118.9224254292382","maxy":"34.29017346391806"},"Campbell":{"minx":"-122.0138242808591","miny":"37.23831076413163","maxx":"-121.8987619485394","maxy":"37.32363400397855"},"Canyon Lake":{"minx":"-117.2971532448144","miny":"33.65243634206241","maxx":"-117.2144246478761","maxy":"33.71422619704897"},"Capitola":{"minx":"-121.9916052379197","miny":"36.95460098393526","maxx":"-121.9093940193009","maxy":"37.00864489657007"},"Carlsbad":{"minx":"-117.3829102520299","miny":"33.02871139148052","maxx":"-117.1783650919059","maxy":"33.21627332617879"},"Carmel-By-The-Sea":{"minx":"-121.9444429447906","miny":"36.51789921038382","maxx":"-121.891191025888","maxy":"36.59154834188705"},"Carpinteria":{"minx":"-119.5608085263363","miny":"34.37514235905902","maxx":"-119.4538262797877","maxy":"34.42206240772271"},"Carson":{"minx":"-118.3124587277555","miny":"33.77260437106547","maxx":"-118.1783950326884","maxy":"33.9071106688327"},"Cathedral City":{"minx":"-116.5432806600765","miny":"33.74350129208525","maxx":"-116.2948100633978","maxy":"33.9250430521913"},"Ceres":{"minx":"-121.0486335673069","miny":"37.55121791856816","maxx":"-120.8971435453228","maxy":"37.63828722598925"},"Cerritos":{"minx":"-118.1292065719378","miny":"33.82762394353093","maxx":"-118.0062214231377","maxy":"33.91424529169932"},"Chico":{"minx":"-121.9474740586294","miny":"39.66394851127401","maxx":"-121.6763786987074","maxy":"39.84950746071308"},"Chino Hills":{"minx":"-117.8345162201994","miny":"33.85961039597621","maxx":"-117.6160010609914","maxy":"34.05118623405024"},"Chino":{"minx":"-117.7790065581721","miny":"33.88977048587379","maxx":"-117.5647475561344","maxy":"34.07773139998074"},"Chowchilla":{"minx":"-120.3110097455266","miny":"37.08355704166497","maxx":"-120.1838996263214","maxy":"37.14382284109601"},"Chula Vista":{"minx":"-117.164093183515","miny":"32.54753435053761","maxx":"-116.8983549002887","maxy":"32.7060982785146"},"Citrus Heights":{"minx":"-121.3576959744802","miny":"38.64472632561252","maxx":"-121.2199832038052","maxy":"38.74408022371004"},"Claremont":{"minx":"-117.7825990160989","miny":"34.06007069823902","maxx":"-117.6579486951432","maxy":"34.17565016837904"},"Clayton":{"minx":"-121.9784843906389","miny":"37.90726816234675","maxx":"-121.8926313299454","maxy":"37.97106169823627"},"Clearlake":{"minx":"-122.7134093952279","miny":"38.89971132023209","maxx":"-122.5709724718583","maxy":"39.01302374324759"},"Cloverdale":{"minx":"-123.0731461646227","miny":"38.7560121394057","maxx":"-122.9613099312405","maxy":"38.84584865343097"},"Clovis":{"minx":"-119.7633957627618","miny":"36.75740161601097","maxx":"-119.5686357733199","maxy":"36.89594993855206"},"Coachella":{"minx":"-116.2513934144613","miny":"33.56926505244662","maxx":"-116.0594997984273","maxy":"33.74766429158237"},"Coalinga":{"minx":"-120.3973624678106","miny":"36.11457387975157","maxx":"-120.2931130300768","maxy":"36.2089954258883"},"Colfax":{"minx":"-120.9849876346049","miny":"39.05808237656451","maxx":"-120.9409291245251","maxy":"39.13512294579206"},"Colma":{"minx":"-122.4921896737293","miny":"37.64625202623258","maxx":"-122.4114954848405","maxy":"37.70889568411501"},"Colton":{"minx":"-117.3917064926019","miny":"34.00103296419837","maxx":"-117.2468862684682","maxy":"34.1121236699897"},"Colusa":{"minx":"-122.0480742879514","miny":"39.1667335393117","maxx":"-121.9663187788663","maxy":"39.2333094641424"},"Commerce":{"minx":"-118.2201275640398","miny":"33.95345519638569","maxx":"-118.1012469266416","maxy":"34.03445963971716"},"Compton":{"minx":"-118.2855702324516","miny":"33.84661816676002","maxx":"-118.1532711276036","maxy":"33.93897170367709"},"Concord":{"minx":"-122.0974076483062","miny":"37.90420867271461","maxx":"-121.89872986248","maxy":"38.03737041525137"},"Corcoran":{"minx":"-119.6257567967918","miny":"36.02146234927028","maxx":"-119.5104784625223","maxy":"36.13800969427176"},"Corning":{"minx":"-122.2351248202856","miny":"39.88151886077019","maxx":"-122.1387423096528","maxy":"39.97509188292451"},"Coronado":{"minx":"-117.2445186498584","miny":"32.56661045260025","maxx":"-117.0925942084772","maxy":"32.73411548526568"},"Corona":{"minx":"-117.7174988358032","miny":"33.7730950562671","maxx":"-117.4533976168248","maxy":"33.94321204922943"},"Corte Madera":{"minx":"-122.552660888867","miny":"37.89042431474713","maxx":"-122.4479669809203","maxy":"37.95991957925595"},"Costa Mesa":{"minx":"-117.9813451749176","miny":"33.60913012880038","maxx":"-117.8414263707509","maxy":"33.72096366005798"},"Cotati":{"minx":"-122.7488272741361","miny":"38.28816473969734","maxx":"-122.6666048243687","maxy":"38.36005732256135"},"Covina":{"minx":"-117.9536641203459","miny":"34.05458259159843","maxx":"-117.8164443926365","maxy":"34.12231125032193"},"Crescent City":{"minx":"-124.23509534837","miny":"41.73610531245252","maxx":"-124.154077216333","maxy":"41.78741563085299"},"Cudahy":{"minx":"-118.2225143914835","miny":"33.93465623652821","maxx":"-118.1499989891254","maxy":"33.99528852822802"},"Culver City":{"minx":"-118.468351825662","miny":"33.9597954837287","maxx":"-118.3427616283623","maxy":"34.0517348463614"},"Cupertino":{"minx":"-122.1121820968532","miny":"37.26356558078744","maxx":"-121.9688061632709","maxy":"37.35999488390891"},"Cypress":{"minx":"-118.0928072385903","miny":"33.77183279282173","maxx":"-117.9930389781932","maxy":"33.86197964824596"},"Daly City":{"minx":"-122.5008868561832","miny":"37.63130334805474","maxx":"-122.3863538418911","maxy":"37.72689772915463"},"Dana Point":{"minx":"-117.752097040708","miny":"33.42920250439084","maxx":"-117.6184365161841","maxy":"33.51806044516206"},"Danville":{"minx":"-122.0504419523442","miny":"37.75698565628679","maxx":"-121.8679016114663","maxy":"37.86679618060328"},"Davis":{"minx":"-121.8218193265971","miny":"38.50207029206761","maxx":"-121.638503215389","maxy":"38.60092910185996"},"Del Mar":{"minx":"-117.2751618717147","miny":"32.92859767472849","maxx":"-117.2336431842463","maxy":"33.00089004326529"},"Del Rey Oaks":{"minx":"-121.8742913827375","miny":"36.57147966860474","maxx":"-121.8082835045495","maxy":"36.62271231131022"},"Delano":{"minx":"-119.3659285072832","miny":"35.68627691888398","maxx":"-119.1695311056809","maxy":"35.83010742098099"},"Desert Hot Springs":{"minx":"-116.6159036056669","miny":"33.90766633085179","maxx":"-116.4405133116207","maxy":"34.00763666102149"},"Diamond Bar":{"minx":"-117.8897754526546","miny":"33.93905467135825","maxx":"-117.7404736393884","maxy":"34.07130572229082"},"Dinuba":{"minx":"-119.4578492627914","miny":"36.50226997678919","maxx":"-119.340434614037","maxy":"36.58953570696234"},"Dixon":{"minx":"-121.8944756811637","miny":"38.36198801685648","maxx":"-121.768967234553","maxy":"38.50426204553256"},"Dorris":{"minx":"-121.9582078827408","miny":"41.95077847381394","maxx":"-121.8822590930964","maxy":"41.99000556434747"},"Dos Palos":{"minx":"-120.662883986456","miny":"36.95265539203908","maxx":"-120.5994218697671","maxy":"37.01107516478594"},"Downey":{"minx":"-118.1903000409942","miny":"33.88735848253461","maxx":"-118.0699644343455","maxy":"33.98902944649376"},"Duarte":{"minx":"-118.0094046516979","miny":"34.10302795004034","maxx":"-117.9127184996129","maxy":"34.16057374330779"},"Dublin":{"minx":"-122.0270693557011","miny":"37.65830447423367","maxx":"-121.7949897288012","maxy":"37.77591796485484"},"Dunsmuir":{"minx":"-122.3029907214627","miny":"41.18375261881073","maxx":"-122.2305944145314","maxy":"41.28779545689856"},"East Palo Alto":{"minx":"-122.1775121749975","miny":"37.43057071301438","maxx":"-122.1029430404302","maxy":"37.49562444362485"},"Eastvale":{"minx":"-117.6413351728658","miny":"33.87944700600752","maxx":"-117.5026190402257","maxy":"34.06148211095652"},"El Cajon":{"minx":"-117.0294596290305","miny":"32.74952980248309","maxx":"-116.8765979863169","maxy":"32.85334208256527"},"El Centro":{"minx":"-115.6207199155721","miny":"32.73059572840283","maxx":"-115.5005903812862","maxy":"32.8402052594025"},"El Cerrito":{"minx":"-122.3427658111457","miny":"37.87999274664694","maxx":"-122.2685895648792","maxy":"37.95350644490204"},"El Paso De Robles":{"minx":"-120.7685206030438","miny":"35.54336114838057","maxx":"-120.5697390912718","maxy":"35.72392713065041"},"El Segundo":{"minx":"-118.4465563324098","miny":"33.88676041804181","maxx":"-118.3526895988746","maxy":"33.95196818996513"},"Emeryville":{"minx":"-122.3230482221949","miny":"37.81130303990258","maxx":"-122.2545251258052","maxy":"37.8663800216703"},"Encinitas":{"minx":"-117.3183564791481","miny":"32.98014860942361","maxx":"-117.1754035092345","maxy":"33.10912673482233"},"Escalon":{"minx":"-121.0343529311371","miny":"37.73271672641145","maxx":"-120.9598290400516","maxy":"37.82769326242693"},"Escondido":{"minx":"-117.1761439445782","miny":"33.02208514236647","maxx":"-116.9542547890325","maxy":"33.23716565869956"},"Etna":{"minx":"-122.9371714497137","miny":"41.42917819320546","maxx":"-122.8471689436403","maxy":"41.49208087161645"},"Eureka":{"minx":"-124.2227714270189","miny":"40.72651983506935","maxx":"-124.0472440783574","maxy":"40.84964119892069"},"Exeter":{"minx":"-119.1811732905396","miny":"36.25360691248615","maxx":"-119.1063495968561","maxy":"36.32525274051353"},"Fairfax":{"minx":"-122.6302580833156","miny":"37.94993100142126","maxx":"-122.5612106003951","maxy":"38.01884312220945"},"Fairfield":{"minx":"-122.2343592875839","miny":"38.11894174743031","maxx":"-121.8665536392035","maxy":"38.36201377824923"},"Farmersville":{"minx":"-119.2431346895343","miny":"36.25413007613221","maxx":"-119.168531920475","maxy":"36.34920595152178"},"Ferndale":{"minx":"-124.3014226587569","miny":"40.56006081741032","maxx":"-124.2306535511163","maxy":"40.60656423284735"},"Fillmore":{"minx":"-118.9661310214541","miny":"34.37108004686812","maxx":"-118.8742036130309","maxy":"34.43471210050313"},"Firebaugh":{"minx":"-120.4915840542551","miny":"36.806995259007","maxx":"-120.4110732747876","maxy":"36.90912955547675"},"Folsom":{"minx":"-121.2481235185486","miny":"38.61407532270464","maxx":"-121.0564225237622","maxy":"38.73630841673011"},"Fontana":{"minx":"-117.5648183582202","miny":"33.98510804991553","maxx":"-117.3613279522954","maxy":"34.21104435446868"},"Fort Bragg":{"minx":"-123.8096538028535","miny":"39.43909074156468","maxx":"-123.7931572797262","maxy":"39.47037353317914"},"Fort Jones":{"minx":"-122.8732367877336","miny":"41.58487452739848","maxx":"-122.8179225873451","maxy":"41.64462081293493"},"Fortuna":{"minx":"-124.1891212921304","miny":"40.53887789062853","maxx":"-124.100622608807","maxy":"40.62946810729988"},"Foster City":{"minx":"-122.3113652476934","miny":"37.50626738536148","maxx":"-122.1548462776033","maxy":"37.61722275965979"},"Fountain Valley":{"minx":"-117.9999523725517","miny":"33.67207729726245","maxx":"-117.8963743599643","maxy":"33.74932630329418"},"Fowler":{"minx":"-119.7184748870129","miny":"36.58006948211904","maxx":"-119.6143497388053","maxy":"36.6635992070418"},"Fremont":{"minx":"-122.149962698654","miny":"37.42155842022822","maxx":"-121.8576118091246","maxy":"37.62982555322407"},"Fresno":{"minx":"-119.9883898523445","miny":"36.62644988085552","maxx":"-119.6100744939875","maxy":"36.93591786378527"},"Fullerton":{"minx":"-118.0264515640832","miny":"33.82753265822276","maxx":"-117.8372509604362","maxy":"33.94844956601657"},"Galt":{"minx":"-121.3557680158891","miny":"38.22204897112448","maxx":"-121.2637250595713","maxy":"38.32573970400728"},"Garden Grove":{"minx":"-118.0749686757396","miny":"33.71637261762198","maxx":"-117.8690214223942","maxy":"33.82394836940191"},"Gardena":{"minx":"-118.3467948988283","miny":"33.84623935506499","maxx":"-118.266928619357","maxy":"33.93987793620037"},"Gilroy":{"minx":"-121.657431674052","miny":"36.95097186706489","maxx":"-121.4907958560924","maxy":"37.07132968521927"},"Glendale":{"minx":"-118.3487885607633","miny":"34.08603379456181","maxx":"-118.1437688845539","maxy":"34.2687321669774"},"Glendora":{"minx":"-117.9088701034062","miny":"34.09067548000617","maxx":"-117.7907509300696","maxy":"34.20411054284971"},"Goleta":{"minx":"-119.9545340184035","miny":"34.4089797195624","maxx":"-119.7686613790347","maxy":"34.4687619717487"},"Gonzales":{"minx":"-121.5038869669291","miny":"36.46623266712677","maxx":"-121.3949701647769","maxy":"36.54503998548234"},"Grand Terrace":{"minx":"-117.3617892043698","miny":"34.00307749218458","maxx":"-117.2716369375321","maxy":"34.06404590831426"},"Grass Valley":{"minx":"-121.1039884666684","miny":"39.17834537620068","maxx":"-120.9838488911174","maxy":"39.25775218946057"},"Greenfield":{"minx":"-121.2825051597236","miny":"36.29352223370521","maxx":"-121.1995109390888","maxy":"36.35277312911593"},"Gridley":{"minx":"-121.7372482045865","miny":"39.33376024732966","maxx":"-121.6597964635901","maxy":"39.39948468068813"},"Grover Beach":{"minx":"-120.6476610221936","miny":"35.08371321863493","maxx":"-120.5819109450868","maxy":"35.14824787944976"},"Guadalupe":{"minx":"-120.5981496337135","miny":"34.93245287862965","maxx":"-120.5400489809491","maxy":"34.99114399659222"},"Gustine":{"minx":"-121.0493989815689","miny":"37.2311330292232","maxx":"-120.9647872148709","maxy":"37.28219388942621"},"Half Moon Bay":{"minx":"-122.4983709525413","miny":"37.4047803968981","maxx":"-122.4133475049926","maxy":"37.5156490467573"},"Hanford":{"minx":"-119.726988065731","miny":"36.23291821114855","maxx":"-119.5649946840144","maxy":"36.40127266436949"},"Hawaiian Gardens":{"minx":"-118.1009680994103","miny":"33.8036174170412","maxx":"-118.0412445943332","maxy":"33.85354694453559"},"Hawthorne":{"minx":"-118.3970706169583","miny":"33.87300316076515","maxx":"-118.2911899009668","maxy":"33.94916818268874"},"Hayward":{"minx":"-122.24557468725","miny":"37.5363755741832","maxx":"-121.8803659223389","maxy":"37.73186851843938"},"Hemet":{"minx":"-117.1061217596571","miny":"33.64574313681193","maxx":"-116.8756605768051","maxy":"33.82102306575875"},"Hercules":{"minx":"-122.3191338558178","miny":"37.96385690563289","maxx":"-122.1860038269033","maxy":"38.04880153069028"},"Hermosa Beach":{"minx":"-118.4151731371195","miny":"33.83820845082609","maxx":"-118.3659072070631","maxy":"33.89352006198565"},"Hesperia":{"minx":"-117.4787771340548","miny":"34.27008682982987","maxx":"-117.2029075090157","maxy":"34.5054916606393"},"Hidden Hills":{"minx":"-118.6967978287933","miny":"34.13798011612793","maxx":"-118.6099985860301","maxy":"34.19466209849882"},"Highland":{"minx":"-117.2941879688966","miny":"34.06186760290556","maxx":"-117.0085552911968","maxy":"34.16549691580527"},"Hillsborough":{"minx":"-122.4066805392396","miny":"37.50942544061922","maxx":"-122.3088710631186","maxy":"37.60079078900169"},"Hollister":{"minx":"-121.472521744734","miny":"36.80093989299491","maxx":"-121.3329375905792","maxy":"36.92477210784008"},"Holtville":{"minx":"-115.428017561053","miny":"32.78914787116753","maxx":"-115.3370247396853","maxy":"32.8401214866252"},"Hughson":{"minx":"-120.9018424010798","miny":"37.56562487751925","maxx":"-120.8289258943942","maxy":"37.62621307602196"},"Huntington Beach":{"minx":"-118.1103981286906","miny":"33.61440437608859","maxx":"-117.90406634487","maxy":"33.78542467055595"},"Huntington Park":{"minx":"-118.2608990779016","miny":"33.94491634682876","maxx":"-118.1645287901104","maxy":"34.01411475058162"},"Huron":{"minx":"-120.1395075153063","miny":"36.16683294970733","maxx":"-120.0674159634122","maxy":"36.22641657098846"},"Imperial":{"minx":"-115.6208840723839","miny":"32.79648556331217","maxx":"-115.5032559048226","maxy":"32.8982584282105"},"Indian Wells":{"minx":"-116.3949292080793","miny":"33.65609915220608","maxx":"-116.2773623259989","maxy":"33.75832710537345"},"Indio":{"minx":"-116.350391880015","miny":"33.64207134080675","maxx":"-116.1228403152363","maxy":"33.84914940018668"},"Industry":{"minx":"-118.0878900129676","miny":"33.966591317369","maxx":"-117.7751346502147","maxy":"34.08926125572149"},"Inglewood":{"minx":"-118.3975727396256","miny":"33.90909713979497","maxx":"-118.2967168953754","maxy":"33.99885578037684"},"Ione":{"minx":"-120.981103918993","miny":"38.32024388537966","maxx":"-120.8928131215157","maxy":"38.39555853809042"},"Irvine":{"minx":"-117.9077406839018","miny":"33.56960851770329","maxx":"-117.6432800896411","maxy":"33.81911133141033"},"Irwindale":{"minx":"-118.0290427470293","miny":"34.05580740619982","maxx":"-117.9022474740036","maxy":"34.15594239503125"},"Isleton":{"minx":"-121.6471733713313","miny":"38.13042926731616","maxx":"-121.5646174044357","maxy":"38.18489780056741"},"Jackson":{"minx":"-120.8197778174432","miny":"38.30976560295844","maxx":"-120.7209466488821","maxy":"38.39024519937197"},"Jurupa Valley":{"minx":"-117.5933551136201","miny":"33.91407799026971","maxx":"-117.3270833059088","maxy":"34.07077364082027"},"Kerman":{"minx":"-120.1058816707301","miny":"36.6910586322422","maxx":"-120.0150837760084","maxy":"36.75702377553559"},"King City":{"minx":"-121.1743565586442","miny":"36.16893834456541","maxx":"-121.0752778934915","maxy":"36.24182797429119"},"Kingsburg":{"minx":"-119.6110745169773","miny":"36.48186614682058","maxx":"-119.5120442626711","maxy":"36.56149692759043"},"La Canada Flintridge":{"minx":"-118.2531862367248","miny":"34.16360000000007","maxx":"-118.1483603757601","maxy":"34.24827663155432"},"La Habra Heights":{"minx":"-118.0113216823276","miny":"33.92615793755481","maxx":"-117.8961323214524","maxy":"33.99308853812456"},"La Habra":{"minx":"-117.997196839192","miny":"33.88953704205849","maxx":"-117.9020969332888","maxy":"33.96986932145029"},"La Mesa":{"minx":"-117.0745508618227","miny":"32.71879458166281","maxx":"-116.9621437416591","maxy":"32.81315509396326"},"La Mirada":{"minx":"-118.0640113907435","miny":"33.85873287347303","maxx":"-117.9563524777079","maxy":"33.94400295370468"},"La Palma":{"minx":"-118.0766306782794","miny":"33.82082828012025","maxx":"-118.0105185950272","maxy":"33.88088162539142"},"La Puente":{"minx":"-118.0031985951414","miny":"33.99339642772019","maxx":"-117.9006669500046","maxy":"34.07360288565195"},"La Quinta":{"minx":"-116.35154343268","miny":"33.56203693914863","maxx":"-116.1290292642289","maxy":"33.77307547705178"},"La Verne":{"minx":"-117.827261662116","miny":"34.07076427274438","maxx":"-117.7288934960254","maxy":"34.16598183101058"},"Lafayette":{"minx":"-122.1903180054243","miny":"37.83104823130306","maxx":"-122.0537412209995","maxy":"37.95746640679251"},"Laguna Beach":{"minx":"-117.8427332951583","miny":"33.46548911337258","maxx":"-117.7026008958684","maxy":"33.63802283043581"},"Laguna Hills":{"minx":"-117.7605625743849","miny":"33.53612227476169","maxx":"-117.6494926274364","maxy":"33.66429817991359"},"Laguna Niguel":{"minx":"-117.761046090429","miny":"33.46904028719058","maxx":"-117.6483133861027","maxy":"33.59568633462775"},"Laguna Woods":{"minx":"-117.7880212972827","miny":"33.57730507754171","maxx":"-117.6801108492808","maxy":"33.65113890581243"},"Lake Elsinore":{"minx":"-117.4533030934905","miny":"33.59659118861137","maxx":"-117.1755986778842","maxy":"33.78912557552388"},"Lake Forest":{"minx":"-117.7582207583695","miny":"33.5852102970848","maxx":"-117.598079818672","maxy":"33.72770195663063"},"Lakeport":{"minx":"-122.9600936611275","miny":"38.99663919598506","maxx":"-122.8939880432165","maxy":"39.08176491869099"},"Lakeside":{"minx":"-116.9653843017343","miny":"32.81474318428663","maxx":"-116.8525058627626","maxy":"32.8923893122295"},"Lakewood":{"minx":"-118.1927579833258","miny":"33.80067960696838","maxx":"-118.035381298869","maxy":"33.88943750098044"},"Lancaster":{"minx":"-118.364278237551","miny":"34.60170931406297","maxx":"-117.8982519629865","maxy":"34.81708248215642"},"Larkspur":{"minx":"-122.5698950799875","miny":"37.90582148519339","maxx":"-122.4775896863934","maxy":"37.97724520019834"},"Lathrop":{"minx":"-121.4148185421806","miny":"37.74798291247222","maxx":"-121.2347747312463","maxy":"37.88883851592637"},"Lawndale":{"minx":"-118.3874793036363","miny":"33.85819404200711","maxx":"-118.3241927220604","maxy":"33.92011358182884"},"Lemon Grove":{"minx":"-117.0831442790602","miny":"32.69882766192323","maxx":"-116.9920090506689","maxy":"32.76548315888195"},"Lemoore":{"minx":"-119.8693183655961","miny":"36.24024791441431","maxx":"-119.7446007476274","maxy":"36.34259889035083"},"Lincoln":{"minx":"-121.4143935485775","miny":"38.80937883035847","maxx":"-121.294916568984","maxy":"38.89735597287257"},"Lindsay":{"minx":"-119.1364479602089","miny":"36.16708659806135","maxx":"-119.0462584339261","maxy":"36.23910823909137"},"Live Oak":{"minx":"-121.7062424075798","miny":"39.23227261440338","maxx":"-121.6311364574077","maxy":"39.31445373935212"},"Livermore":{"minx":"-121.8835995615133","miny":"37.60230090715459","maxx":"-121.6490187797726","maxy":"37.76708740740148"},"Livingston":{"minx":"-120.790462945413","miny":"37.35313904042275","maxx":"-120.6770190710664","maxy":"37.41945049992297"},"Lodi":{"minx":"-121.3347598164182","miny":"38.06841546909208","maxx":"-121.2149183585883","maxy":"38.17501061774556"},"Loma Linda":{"minx":"-117.298822964044","miny":"34.00393303742366","maxx":"-117.1999586096864","maxy":"34.08923621516551"},"Lomita":{"minx":"-118.3511650708203","miny":"33.75900390749405","maxx":"-118.2818779678669","maxy":"33.82347760645124"},"Lompoc":{"minx":"-120.5367031662665","miny":"34.61326840591981","maxx":"-120.4212239608059","maxy":"34.71324827643778"},"Long Beach":{"minx":"-118.2867908951109","miny":"33.72758360448421","maxx":"-118.0281524256123","maxy":"33.91873009201037"},"Loomis":{"minx":"-121.2325843446424","miny":"38.75589137425016","maxx":"-121.1502457906009","maxy":"38.86267275137225"},"Los Alamitos":{"minx":"-118.1126955854366","miny":"33.76066011355476","maxx":"-118.0125247731782","maxy":"33.83508613795699"},"Los Altos Hills":{"minx":"-122.1925744181649","miny":"37.33354124418547","maxx":"-122.068304645379","maxy":"37.41532873346266"},"Los Altos":{"minx":"-122.1589345866969","miny":"37.3105915951251","maxx":"-122.0358383112442","maxy":"37.42426678739931"},"Los Angeles":{"minx":"-118.6967977935305","miny":"33.70588979435277","maxx":"-118.1068000479012","maxy":"34.37201333891713"},"Los Banos":{"minx":"-120.9130525982483","miny":"37.020131160097","maxx":"-120.7621520208112","maxy":"37.1042042016739"},"Los Gatos":{"minx":"-122.0203667629507","miny":"37.17280878133923","maxx":"-121.8798064799254","maxy":"37.28281057069804"},"Loyalton":{"minx":"-120.2746928970495","miny":"39.65152937976519","maxx":"-120.2156131652579","maxy":"39.69710827307274"},"Lynwood":{"minx":"-118.2542760981732","miny":"33.88569266855876","maxx":"-118.153271078608","maxy":"33.96163657207488"},"Madera":{"minx":"-120.2242466592962","miny":"36.88018468276191","maxx":"-119.986415508257","maxy":"37.04050706079585"},"Malibu":{"minx":"-118.9632157248352","miny":"34.00524373904134","maxx":"-118.5421489640986","maxy":"34.09121037687172"},"Mammoth Lakes":{"minx":"-119.0748258217311","miny":"37.5955430746779","maxx":"-118.8935448831548","maxy":"37.68384663565793"},"Manhattan Beach":{"minx":"-118.4345150906956","miny":"33.85547326007322","maxx":"-118.3575661356337","maxy":"33.92982502390206"},"Maricopa":{"minx":"-119.4479790165585","miny":"35.03373420458389","maxx":"-119.3668321592787","maxy":"35.08438111174669"},"Marina":{"minx":"-121.825058311161","miny":"36.63667932679006","maxx":"-121.7326285810698","maxy":"36.74225229633542"},"Martinez":{"minx":"-122.1826793210287","miny":"37.93430570185021","maxx":"-122.0501898101232","maxy":"38.05724146092172"},"Marysville":{"minx":"-121.6279800952619","miny":"39.11212801825867","maxx":"-121.5295141814313","maxy":"39.20322350213746"},"Maywood":{"minx":"-118.2227364180047","miny":"33.96400269464037","maxx":"-118.1503011594088","maxy":"34.01402862258519"},"Mcfarland":{"minx":"-119.312077867759","miny":"35.64148784669947","maxx":"-119.1868862051226","maxy":"35.71795230068651"},"Mendota":{"minx":"-120.4232095717981","miny":"36.70542593614515","maxx":"-120.3526694992602","maxy":"36.79324146221208"},"Menlo Park":{"minx":"-122.2582371910945","miny":"37.39189565616709","maxx":"-122.1029430404302","maxy":"37.4989109109103"},"Merced":{"minx":"-120.5785974886987","miny":"37.18579222786901","maxx":"-120.3429906156362","maxy":"37.41936958784743"},"Mill Valley":{"minx":"-122.6041551810327","miny":"37.86028417244466","maxx":"-122.4916859235553","maxy":"37.93781007504936"},"Millbrae":{"minx":"-122.4420872640456","miny":"37.56947574209818","maxx":"-122.3563880944763","maxy":"37.634501085267"},"Milpitas":{"minx":"-121.9642921541078","miny":"37.37793169526238","maxx":"-121.8197416479804","maxy":"37.49137338268687"},"Mission Viejo":{"minx":"-117.7324633069455","miny":"33.50451600579173","maxx":"-117.5875663078778","maxy":"33.70473836043669"},"Modesto":{"minx":"-121.1141608216279","miny":"37.5656524183421","maxx":"-120.8478791626263","maxy":"37.73523272130893"},"Monrovia":{"minx":"-118.0459423997819","miny":"34.08745591116421","maxx":"-117.9529219962064","maxy":"34.19553047279457"},"Montague":{"minx":"-122.5776238317632","miny":"41.69840923857737","maxx":"-122.4765172792029","maxy":"41.75098575639656"},"Montclair":{"minx":"-117.7425739424016","miny":"34.0309218167617","maxx":"-117.6507178928182","maxy":"34.11248141767954"},"Monte Sereno":{"minx":"-122.0250650081624","miny":"37.19884535855613","maxx":"-121.9439564878473","maxy":"37.27492829627133"},"Montebello":{"minx":"-118.1780441528308","miny":"33.95712452024461","maxx":"-118.0544125992587","maxy":"34.06272596683726"},"Monterey Park":{"minx":"-118.1978884225426","miny":"34.01113815991387","maxx":"-118.0686568608147","maxy":"34.08984538888198"},"Monterey":{"minx":"-121.9533508857556","miny":"36.55266062723611","maxx":"-121.7610643477938","maxy":"36.63264679983396"},"Moorpark":{"minx":"-118.9460004555358","miny":"34.23410143090918","maxx":"-118.7960297776481","maxy":"34.33365668354235"},"Moraga":{"minx":"-122.1848997807487","miny":"37.79825872907104","maxx":"-122.0689853574067","maxy":"37.89089110299145"},"Moreno Valley":{"minx":"-117.3330439041834","miny":"33.8228830491627","maxx":"-117.0332722346691","maxy":"34.01460532485478"},"Morgan Hill":{"minx":"-121.7331779321152","miny":"37.06785782005628","maxx":"-121.5698978452208","maxy":"37.18767419938681"},"Morro Bay":{"minx":"-120.8823890187585","miny":"35.32404488354486","maxx":"-120.7844045816948","maxy":"35.43104777119689"},"Mount Shasta":{"minx":"-122.3683068197981","miny":"41.27571682899798","maxx":"-122.272559837464","maxy":"41.36582636823333"},"Mountain View":{"minx":"-122.1456341266001","miny":"37.3358075814625","maxx":"-122.0147171900821","maxy":"37.45180546328071"},"Murrieta":{"minx":"-117.3152840893251","miny":"33.48222842725016","maxx":"-117.0471015552363","maxy":"33.68592231251304"},"Napa":{"minx":"-122.4021078083293","miny":"38.19383461772225","maxx":"-122.1928208649133","maxy":"38.38571868378626"},"National City":{"minx":"-117.1409002634916","miny":"32.62897732717628","maxx":"-117.0312048856034","maxy":"32.71018611338334"},"Needles":{"minx":"-114.7000386590237","miny":"34.74617025541483","maxx":"-114.5151462090809","maxy":"34.95303391660639"},"Nevada City":{"minx":"-121.0647534977575","miny":"39.22573640399661","maxx":"-120.9854836107647","maxy":"39.29663516585842"},"Newark":{"minx":"-122.0896549336012","miny":"37.49567344625195","maxx":"-121.9690690142813","maxy":"37.58183125630389"},"Newman":{"minx":"-121.0676260838832","miny":"37.2819418957605","maxx":"-120.9788101451676","maxy":"37.3475612342223"},"Newport Beach":{"minx":"-117.9882867514005","miny":"33.54723290535835","maxx":"-117.7357486224457","maxy":"33.70123719938537"},"Norco":{"minx":"-117.6286756205895","miny":"33.86990040260552","maxx":"-117.490576170956","maxy":"33.98101083235634"},"Norwalk":{"minx":"-118.1336319706958","miny":"33.86101492694517","maxx":"-118.0199554199582","maxy":"33.95635582819436"},"Novato":{"minx":"-122.6619441056734","miny":"38.01473741755815","maxx":"-122.4762436014577","maxy":"38.17887187305272"},"Oakdale":{"minx":"-120.9048758926994","miny":"37.7326767826987","maxx":"-120.7565953555493","maxy":"37.80954203374291"},"Oakland":{"minx":"-122.3911458400283","miny":"37.67331100677209","maxx":"-122.0738288539175","maxy":"37.91260187209249"},"Oakley":{"minx":"-121.7865463675583","miny":"37.94361660528815","maxx":"-121.6017190485931","maxy":"38.04548332558097"},"Oceanside":{"minx":"-117.3980403147811","miny":"33.11974557277332","maxx":"-117.2028729228884","maxy":"33.32919663269892"},"Ojai":{"minx":"-119.292855419945","miny":"34.40651629592055","maxx":"-119.1972602478659","maxy":"34.46941063410733"},"Ontario":{"minx":"-117.7277762128268","miny":"33.94179659170307","maxx":"-117.4811120868115","maxy":"34.12162437455162"},"Orange Cove":{"minx":"-119.3631896510316","miny":"36.5740575083286","maxx":"-119.277906526407","maxy":"36.66093219017429"},"Orange":{"minx":"-117.9386417532619","miny":"33.72052025463891","maxx":"-117.6831007032264","maxy":"33.8764182841378"},"Orinda":{"minx":"-122.2489975906091","miny":"37.8185363168947","maxx":"-122.1168695347529","maxy":"37.94737654295088"},"Orland":{"minx":"-122.2390894962013","miny":"39.70965627144861","maxx":"-122.1408112348874","maxy":"39.78712674180565"},"Oroville":{"minx":"-121.6615161428231","miny":"39.41255571973489","maxx":"-121.4757755539724","maxy":"39.55799563147185"},"Oxnard":{"minx":"-119.2652788591727","miny":"34.12129459126559","maxx":"-119.0697073995035","maxy":"34.2866286838935"},"Pacific Grove":{"minx":"-121.9615233902291","miny":"36.58319237792386","maxx":"-121.8924698853918","maxy":"36.63644224404555"},"Pacifica":{"minx":"-122.516129092538","miny":"37.5461039720933","maxx":"-122.4087747627842","maxy":"37.69021394893412"},"Palm Desert":{"minx":"-116.4324355271558","miny":"33.67244932230806","maxx":"-116.2653667631522","maxy":"33.84552700959081"},"Palm Springs":{"minx":"-116.7198010716991","miny":"33.73810017965405","maxx":"-116.4233718633319","maxy":"33.97876359746011"},"Palmdale":{"minx":"-118.3343358516808","miny":"34.46994949183287","maxx":"-117.874543773374","maxy":"34.69034678921733"},"Palo Alto":{"minx":"-122.2205737204038","miny":"37.29574867627065","maxx":"-122.0779406837687","maxy":"37.4773524098413"},"Palos Verdes Estates":{"minx":"-118.4265972915172","miny":"33.74470237902867","maxx":"-118.3310390002744","maxy":"33.82047692084341"},"Paradise":{"minx":"-121.6811431688539","miny":"39.70344958200663","maxx":"-121.5635859764886","maxy":"39.82788643362279"},"Paramount":{"minx":"-118.2074136115468","miny":"33.86010599075243","maxx":"-118.1192090444346","maxy":"33.93482406131673"},"Parlier":{"minx":"-119.5930982958053","miny":"36.56861769408284","maxx":"-119.4840737728018","maxy":"36.6483684134327"},"Pasadena":{"minx":"-118.2220281898679","miny":"34.09357089196655","maxx":"-118.036067926577","maxy":"34.26986739934127"},"Patterson":{"minx":"-121.1959502764435","miny":"37.42753784141262","maxx":"-121.0672036545938","maxy":"37.52234509324279"},"Perris":{"minx":"-117.307564547729","miny":"33.68415715404036","maxx":"-117.1364355605949","maxy":"33.90423073654794"},"Petaluma":{"minx":"-122.7153959970665","miny":"38.16480428184678","maxx":"-122.5346470805157","maxy":"38.33344350120028"},"Pico Rivera":{"minx":"-118.1444066909313","miny":"33.93083141610317","maxx":"-118.0205450719086","maxy":"34.04664865446928"},"Piedmont":{"minx":"-122.2724703789513","miny":"37.7943862641091","maxx":"-122.1916864880869","maxy":"37.85034613375201"},"Pinole":{"minx":"-122.3529573278004","miny":"37.95744038812422","maxx":"-122.2294359583544","maxy":"38.02461664465807"},"Pismo Beach":{"minx":"-120.7390061250224","miny":"35.10890500259165","maxx":"-120.5797750616569","maxy":"35.21144596172821"},"Pittsburg":{"minx":"-122.0309722305746","miny":"37.95660914909538","maxx":"-121.8000908428618","maxy":"38.04626755588183"},"Placentia":{"minx":"-117.907067259182","miny":"33.83672812821367","maxx":"-117.7905504943346","maxy":"33.9247750497824"},"Placerville":{"minx":"-120.8680085967601","miny":"38.69982344832532","maxx":"-120.7298607332191","maxy":"38.76305671673065"},"Pleasant Hill":{"minx":"-122.1263135553321","miny":"37.90358702454115","maxx":"-122.0298371199016","maxy":"38.00116979711337"},"Pleasanton":{"minx":"-122.0167123807166","miny":"37.59281600299096","maxx":"-121.7566223928806","maxy":"37.73826395637843"},"Plymouth":{"minx":"-120.8810669889078","miny":"38.45391725127612","maxx":"-120.8088532439868","maxy":"38.50942753524734"},"Point Arena":{"minx":"-123.7099871118866","miny":"38.88311581811093","maxx":"-123.6425708529837","maxy":"38.93664522915659"},"Pomona":{"minx":"-117.8549382784749","miny":"33.99619418856367","maxx":"-117.6842381318902","maxy":"34.13384535320689"},"Port Hueneme":{"minx":"-119.2398461781132","miny":"34.13873977214928","maxx":"-119.1665637640062","maxy":"34.19759231406113"},"Porterville":{"minx":"-119.1255432940798","miny":"35.98585366903753","maxx":"-118.9370629782183","maxy":"36.13838996332563"},"Portola Valley":{"minx":"-122.2662260118175","miny":"37.32488418844744","maxx":"-122.1677514732007","maxy":"37.41729502835618"},"Portola":{"minx":"-120.4991661108715","miny":"39.80080792155098","maxx":"-120.4297906212158","maxy":"39.82438803008645"},"Poway":{"minx":"-117.119612384641","miny":"32.90078154867291","maxx":"-116.9284133962348","maxy":"33.08591511814282"},"Rancho Cordova":{"minx":"-121.3725435624445","miny":"38.47226193100738","maxx":"-121.1551267642601","maxy":"38.66116892555888"},"Rancho Cucamonga":{"minx":"-117.6760397633882","miny":"34.04346536442149","maxx":"-117.4398767199728","maxy":"34.17925667127861"},"Rancho Mirage":{"minx":"-116.4843229969515","miny":"33.69238152775872","maxx":"-116.3486922692108","maxy":"33.86131853314824"},"Rancho Palos Verdes":{"minx":"-118.4265973274513","miny":"33.71555566893009","maxx":"-118.2799484883973","maxy":"33.81402833377241"},"Rancho Santa Margarita":{"minx":"-117.6608152141058","miny":"33.57379352861655","maxx":"-117.5544364840259","maxy":"33.68938273141646"},"Red Bluff":{"minx":"-122.30309159311","miny":"40.11471723114748","maxx":"-122.1646987416439","maxy":"40.25819902007868"},"Redding":{"minx":"-122.4941493272367","miny":"40.43855067062994","maxx":"-122.2329580249926","maxy":"40.71660818704123"},"Redlands":{"minx":"-117.287365578345","miny":"33.95724130594421","maxx":"-117.0085552962805","maxy":"34.13216954240354"},"Redondo Beach":{"minx":"-118.4089639276339","miny":"33.79675347361758","maxx":"-118.3261151021374","maxy":"33.91637518973953"},"Redwood City":{"minx":"-122.3122527144436","miny":"37.42917040711994","maxx":"-122.1502825196962","maxy":"37.54838420506448"},"Reedley":{"minx":"-119.5025536200874","miny":"36.546427106438","maxx":"-119.3949001686138","maxy":"36.63330915967936"},"Rialto":{"minx":"-117.4791774465619","miny":"33.9873975930058","maxx":"-117.3054858338159","maxy":"34.2192184055181"},"Richmond":{"minx":"-122.4778105275039","miny":"37.870971423489","maxx":"-122.2006457173113","maxy":"38.01232691469701"},"Ridgecrest":{"minx":"-117.7409595014044","miny":"35.56697878919574","maxx":"-117.5958948335259","maxy":"35.65450419549573"},"Rio Dell":{"minx":"-124.1539863546153","miny":"40.46814132552252","maxx":"-124.0827617802959","maxy":"40.52435469921191"},"Rio Vista":{"minx":"-121.7540380697755","miny":"38.12297668879433","maxx":"-121.6429399524429","maxy":"38.21944289997278"},"Ripon":{"minx":"-121.1794831987437","miny":"37.71061529938977","maxx":"-121.0847159668487","maxy":"37.79047232017604"},"Riverbank":{"minx":"-120.9949442841214","miny":"37.69022033331434","maxx":"-120.8938793438804","maxy":"37.75844925417084"},"Riverside":{"minx":"-117.5584338345172","miny":"33.84085633347426","maxx":"-117.2349928704826","maxy":"34.05415025016045"},"Rocklin":{"minx":"-121.3286702442507","miny":"38.74991437826374","maxx":"-121.1638674903568","maxy":"38.87217420415173"},"Rohnert Park":{"minx":"-122.7495021903966","miny":"38.29853857938608","maxx":"-122.6500987255793","maxy":"38.38715424818286"},"Rolling Hills Estates":{"minx":"-118.4077891429301","miny":"33.74529439773035","maxx":"-118.2974288725197","maxy":"33.81288373710766"},"Rolling Hills":{"minx":"-118.3849920803764","miny":"33.72730936681891","maxx":"-118.3095825476671","maxy":"33.79501669324829"},"Roseville":{"minx":"-121.4514321187054","miny":"38.6848963232575","maxx":"-121.1427634472239","maxy":"38.8511988524047"},"Ross":{"minx":"-122.5895004096339","miny":"37.94024996840397","maxx":"-122.5209387004601","maxy":"37.98700716502639"},"Sacramento":{"minx":"-121.6247826932387","miny":"38.40535641188323","maxx":"-121.2978545782045","maxy":"38.72046787430637"},"Salinas":{"minx":"-121.7080163905267","miny":"36.61989383297462","maxx":"-121.5517207616101","maxy":"36.75647505673227"},"San Anselmo":{"minx":"-122.6080401028198","miny":"37.95456783258932","maxx":"-122.5303869693969","maxy":"38.01884309268658"},"San Bernardino":{"minx":"-117.4679539449328","miny":"34.02212946097725","maxx":"-117.1456116494901","maxy":"34.29630120534839"},"San Bruno":{"minx":"-122.4925253836104","miny":"37.58541386962267","maxx":"-122.3752034721385","maxy":"37.66060700159556"},"San Carlos":{"minx":"-122.3317562423837","miny":"37.45629757954157","maxx":"-122.2187252581329","maxy":"37.54131033427723"},"San Clemente":{"minx":"-117.6904319392612","miny":"33.38342733365484","maxx":"-117.5705832170818","maxy":"33.50270104196759"},"San Diego":{"minx":"-117.2823846201481","miny":"32.48667697783931","maxx":"-116.8763228530148","maxy":"33.1423394885109"},"San Dimas":{"minx":"-117.8747177805366","miny":"34.04667662872627","maxx":"-117.7503100812167","maxy":"34.16598182875192"},"San Fernando":{"minx":"-118.4741063494391","miny":"34.25312832972727","maxx":"-118.3949887417699","maxy":"34.32094551710432"},"San Francisco":{"minx":"-122.5396589069405","miny":"37.66957584127635","maxx":"-122.3044521220457","maxy":"37.8613292009158"},"San Gabriel":{"minx":"-118.1391230359255","miny":"34.05432365081809","maxx":"-118.0581742863474","maxy":"34.13285091072771"},"San Jacinto":{"minx":"-117.0881520291597","miny":"33.72731328560521","maxx":"-116.8738020778268","maxy":"33.8698324533806"},"San Joaquin":{"minx":"-120.2434659846644","miny":"36.57456377784685","maxx":"-120.1421808159209","maxy":"36.63263048973113"},"San Jose":{"minx":"-122.0728979231548","miny":"37.10992238587227","maxx":"-121.6131289520155","maxy":"37.50422026675255"},"San Juan Bautista":{"minx":"-121.5694908496571","miny":"36.81440484420847","maxx":"-121.493430545598","maxy":"36.87091115400413"},"San Juan Capistrano":{"minx":"-117.7112152042273","miny":"33.44145040905594","maxx":"-117.5900116994633","maxy":"33.57467390897752"},"San Leandro":{"minx":"-122.2294746693809","miny":"37.66279169284958","maxx":"-122.0962464791024","maxy":"37.76889415785747"},"San Luis Obispo":{"minx":"-120.7193396110223","miny":"35.20538599636706","maxx":"-120.6023796864378","maxy":"35.32302295039892"},"San Marcos":{"minx":"-117.2594637639607","miny":"33.07332035130683","maxx":"-117.0832480312608","maxy":"33.20870370945211"},"San Marino":{"minx":"-118.1633956808711","miny":"34.08956529847556","maxx":"-118.0647752854798","maxy":"34.15243877299579"},"San Mateo":{"minx":"-122.3751988684266","miny":"37.49975382673926","maxx":"-122.250946726381","maxy":"37.59193541547156"},"San Pablo":{"minx":"-122.3779865676851","miny":"37.93219628188089","maxx":"-122.2996653587285","maxy":"37.998779907247"},"San Rafael":{"minx":"-122.5983181662075","miny":"37.92724834325153","maxx":"-122.4013657326458","maxy":"38.05174017525924"},"San Ramon":{"minx":"-122.0351316538961","miny":"37.69874979081307","maxx":"-121.8320057723928","maxy":"37.81534147737388"},"Sand City":{"minx":"-121.8708383154081","miny":"36.5943773276415","maxx":"-121.8175376668838","maxy":"36.64529062932128"},"Sanger":{"minx":"-119.6104810614036","miny":"36.66308177054739","maxx":"-119.5112516674476","maxy":"36.73600477715032"},"Santa Ana":{"minx":"-117.9716123816923","miny":"33.66750687891803","maxx":"-117.8028086150707","maxy":"33.80699609969282"},"Santa Barbara":{"minx":"-119.7956821518326","miny":"34.39595414560505","maxx":"-119.605318481859","maxy":"34.49120992890207"},"Santa Clara":{"minx":"-122.0309932984826","miny":"37.29423361635502","maxx":"-121.9002363596583","maxy":"37.43940391160815"},"Santa Clarita":{"minx":"-118.6557383989761","miny":"34.31033111828076","maxx":"-118.3344835483466","maxy":"34.53641367938392"},"Santa Cruz":{"minx":"-122.1358942951117","miny":"36.949272087373","maxx":"-121.9653016543744","maxy":"37.03178795026005"},"Santa Fe Springs":{"minx":"-118.1230644377454","miny":"33.85874346758678","maxx":"-118.001857151612","maxy":"33.99779434468773"},"Santa Maria":{"minx":"-120.546499578216","miny":"34.84810924644759","maxx":"-120.3476135857228","maxy":"35.01484825687651"},"Santa Monica":{"minx":"-118.5358409329206","miny":"33.98436909578508","maxx":"-118.4250747922069","maxy":"34.06726890505309"},"Santa Paula":{"minx":"-119.1178924305879","miny":"34.31442215674745","maxx":"-119.0117220317068","maxy":"34.40408159233359"},"Santa Rosa":{"minx":"-122.8678567424528","miny":"38.33801215338419","maxx":"-122.5156709283454","maxy":"38.54927050348107"},"Santee":{"minx":"-117.0561797210004","miny":"32.79792645273834","maxx":"-116.918056610359","maxy":"32.8995856763705"},"Saratoga":{"minx":"-122.0939355495724","miny":"37.22633861246695","maxx":"-121.9680968520461","maxy":"37.31958711298893"},"Sausalito":{"minx":"-122.5227713718293","miny":"37.82691742280762","maxx":"-122.4734060519804","maxy":"37.88798252383246"},"Scotts Valley":{"minx":"-122.0600580354238","miny":"37.00190449028342","maxx":"-121.9620261340167","maxy":"37.09874055649603"},"Seal Beach":{"minx":"-118.1283999705561","miny":"33.71199688109431","maxx":"-118.0125246949208","maxy":"33.80551103686818"},"Seaside":{"minx":"-121.8763907199596","miny":"36.5790677610353","maxx":"-121.7664516084916","maxy":"36.67294806511328"},"Sebastopol":{"minx":"-122.8539208946663","miny":"38.36771500174252","maxx":"-122.8113548806634","maxy":"38.4003428418127"},"Selma":{"minx":"-119.6647647868394","miny":"36.53239111101058","maxx":"-119.5565194199464","maxy":"36.61992876582151"},"Shasta Lake":{"minx":"-122.4392849132591","miny":"40.63096335722841","maxx":"-122.3177335136033","maxy":"40.72836325180036"},"Sierra Madre":{"minx":"-118.0871816956913","miny":"34.1317641840072","maxx":"-118.0199848029057","maxy":"34.19553047972711"},"Signal Hill":{"minx":"-118.2074508419857","miny":"33.77344463017223","maxx":"-118.130895751015","maxy":"33.83663699886187"},"Simi Valley":{"minx":"-118.8747651951808","miny":"34.17551556601952","maxx":"-118.5909359301672","maxy":"34.32745950149793"},"Solana Beach":{"minx":"-117.2823846072421","miny":"32.95373895916003","maxx":"-117.2170250867772","maxy":"33.02576984575405"},"Soledad":{"minx":"-121.359761753872","miny":"36.38051942347717","maxx":"-121.2779952030432","maxy":"36.46527553568936"},"Solvang":{"minx":"-120.170763760524","miny":"34.55405466283597","maxx":"-120.1019583578294","maxy":"34.6339663752732"},"Sonoma":{"minx":"-122.503087202929","miny":"38.25921556869056","maxx":"-122.3948610015531","maxy":"38.32408433855073"},"Sonora":{"minx":"-120.4183947551111","miny":"37.94688706088985","maxx":"-120.3351753391758","maxy":"38.01843204948752"},"South Gate":{"minx":"-118.253573874731","miny":"33.89288416758904","maxx":"-118.133662228198","maxy":"33.98171432480069"},"South Lake Tahoe":{"minx":"-120.0430533854304","miny":"38.86397840703147","maxx":"-119.9220759786875","maxy":"38.98199773111811"},"South Pasadena":{"minx":"-118.1980503523395","miny":"34.07885123416737","maxx":"-118.1155922376724","maxy":"34.14389036149574"},"South San Francisco":{"minx":"-122.4912378178716","miny":"37.61589179056783","maxx":"-122.3738584174374","maxy":"37.70088492937074"},"Stanton":{"minx":"-118.0371497730506","miny":"33.75827825133245","maxx":"-117.9490640432036","maxy":"33.83220967400091"},"Stockton":{"minx":"-121.4691416861521","miny":"37.84753556482593","maxx":"-121.1471947953112","maxy":"38.11207785196002"},"Suisun City":{"minx":"-122.0834073943294","miny":"38.22057689936948","maxx":"-121.9514705768422","maxy":"38.28036424458042"},"Sunnyvale":{"minx":"-122.1072128093024","miny":"37.30324189475855","maxx":"-121.9506008822279","maxy":"37.43141301104681"},"Susanville":{"minx":"-120.7007497710576","miny":"40.38314473399283","maxx":"-120.5986773677886","maxy":"40.44351158586456"},"Sutter Creek":{"minx":"-120.8696268846254","miny":"38.34788284682028","maxx":"-120.7656816873845","maxy":"38.42194346096219"},"Taft":{"minx":"-119.5212750972047","miny":"35.05812506708004","maxx":"-119.3402371520628","maxy":"35.18071239215691"},"Tehachapi":{"minx":"-118.4951135209352","miny":"35.09500849987656","maxx":"-118.3768469466659","maxy":"35.148470619877"},"Tehama":{"minx":"-122.1633790073838","miny":"39.99956716992889","maxx":"-122.0997533253125","maxy":"40.05554088175353"},"Temecula":{"minx":"-117.2361099062926","miny":"33.39189430677182","maxx":"-117.0227696734781","maxy":"33.57897225261927"},"Temple City":{"minx":"-118.0998660202407","miny":"34.06875738495068","maxx":"-118.0083187934976","maxy":"34.1443722788981"},"Thousand Oaks":{"minx":"-119.0466336534164","miny":"34.08850283102045","maxx":"-118.7503925034259","maxy":"34.2850282586702"},"Tiburon":{"minx":"-122.5266757931516","miny":"37.86264988493968","maxx":"-122.4439225233462","maxy":"37.92482334108824"},"Torrance":{"minx":"-118.4211090507523","miny":"33.7589751268421","maxx":"-118.2742239785254","maxy":"33.90928265079836"},"Tracy":{"minx":"-121.5746572864477","miny":"37.651177195945","maxx":"-121.3437215996623","maxy":"37.79820157308241"},"Trinidad":{"minx":"-124.1532964540441","miny":"41.04002920833629","maxx":"-124.1026415369425","maxy":"41.09074634044426"},"Truckee":{"minx":"-120.3719744421819","miny":"39.2781422077886","maxx":"-120.0249571484902","maxy":"39.41895632123988"},"Tulare":{"minx":"-119.4214969870744","miny":"36.08741598049946","maxx":"-119.2599900788409","maxy":"36.27038447743382"},"Tulelake":{"minx":"-121.5107895345211","miny":"41.9360637506548","maxx":"-121.4374432271642","maxy":"41.97912733964596"},"Turlock":{"minx":"-120.9309672267949","miny":"37.44879894853089","maxx":"-120.7759368003782","maxy":"37.56584564408833"},"Tustin":{"minx":"-117.8681762723697","miny":"33.67321643425127","maxx":"-117.7408874340404","maxy":"33.80359370944593"},"Twentynine Palms":{"minx":"-116.2296257300375","miny":"34.02051780917106","maxx":"-115.9399094576586","maxy":"34.24463595519327"},"Ukiah":{"minx":"-123.26476809415","miny":"39.09486753701586","maxx":"-123.154510110008","maxy":"39.18908292620326"},"Union City":{"minx":"-122.099632492507","miny":"37.54427857999676","maxx":"-121.982948978271","maxy":"37.63535970048701"},"Upland":{"minx":"-117.7310153118841","miny":"34.07032950791491","maxx":"-117.5981177679334","maxy":"34.17521110253549"},"Vacaville":{"minx":"-122.0806262548696","miny":"38.27610758569174","maxx":"-121.8516113378383","maxy":"38.46071318569334"},"Vallejo":{"minx":"-122.4222180995509","miny":"38.02539907038241","maxx":"-122.1346868412434","maxy":"38.20157442750711"},"Ventura County":{"minx":"-119.4338629972707","miny":"34.0478758150311","maxx":"-118.6328547203402","maxy":"34.80967910653261"},"Ventura":{"minx":"-119.3578835332405","miny":"34.19888514235701","maxx":"-119.1038928280121","maxy":"34.40090684301732"},"Vernon":{"minx":"-118.2591952674051","miny":"33.96400266743173","maxx":"-118.1453731102667","maxy":"34.03449383189971"},"Victorville":{"minx":"-117.5038450782467","miny":"34.40499015696736","maxx":"-117.2163692585644","maxy":"34.67476816465265"},"Villa Park":{"minx":"-117.8455162362007","miny":"33.78719830396712","maxx":"-117.7735666109418","maxy":"33.84870868227051"},"Visalia":{"minx":"-119.5112401236923","miny":"36.24031982045448","maxx":"-119.1685319188377","maxy":"36.40464362175134"},"Vista":{"minx":"-117.3236772722094","miny":"33.10715952128784","maxx":"-117.1705550649785","maxy":"33.25923760551314"},"Walnut Creek":{"minx":"-122.1229092436207","miny":"37.8413622440381","maxx":"-121.9633998553156","maxy":"37.96386381903259"},"Walnut":{"minx":"-117.9176581525399","miny":"33.98781463142705","maxx":"-117.8005859363524","maxy":"34.07858949338539"},"Wasco":{"minx":"-119.4385747884697","miny":"35.53591673568693","maxx":"-119.2946312736324","maxy":"35.63068027163796"},"Waterford":{"minx":"-120.7971264817712","miny":"37.61648097078219","maxx":"-120.7345136076452","maxy":"37.66730295980609"},"Watsonville":{"minx":"-121.8479664150326","miny":"36.85994962585882","maxx":"-121.7103939933264","maxy":"36.97778782120101"},"Weed":{"minx":"-122.4339111394674","miny":"41.36560002804699","maxx":"-122.3519069538123","maxy":"41.46002856168679"},"West Covina":{"minx":"-118.0008081695223","miny":"33.9804964359197","maxx":"-117.8338727608101","maxy":"34.11207484485023"},"West Hollywood":{"minx":"-118.4152111324228","miny":"34.0593069360756","maxx":"-118.3236245258192","maxy":"34.11493376595569"},"West Sacramento":{"minx":"-121.5902331999533","miny":"38.48001794418692","maxx":"-121.4768034894636","maxy":"38.63186782497009"},"Westlake Village":{"minx":"-118.8773547623345","miny":"34.08850281288768","maxx":"-118.7658757573088","maxy":"34.18313055693902"},"Westminster":{"minx":"-118.0749686822083","miny":"33.70126291006899","maxx":"-117.921839827976","maxy":"33.7938272785244"},"Westmorland":{"minx":"-115.6646930600829","miny":"33.01547548768713","maxx":"-115.5956391388119","maxy":"33.05192556524146"},"Wheatland":{"minx":"-121.4787542036169","miny":"38.98130459665501","maxx":"-121.3841302068628","maxy":"39.03919317535264"},"Whittier":{"minx":"-118.0987631948463","miny":"33.90260347217184","maxx":"-117.9397631039872","maxy":"34.05192323201886"},"Wildomar":{"minx":"-117.3292278096929","miny":"33.56077458869026","maxx":"-117.1866147559355","maxy":"33.67468673361132"},"Williams":{"minx":"-122.1989482373288","miny":"39.1009625130023","maxx":"-122.0785411743264","maxy":"39.19844324140432"},"Willits":{"minx":"-123.3962747640187","miny":"39.35411175029327","maxx":"-123.2667005016818","maxy":"39.46991633053997"},"Willows":{"minx":"-122.2494151159585","miny":"39.46557479335834","maxx":"-122.1460800400091","maxy":"39.55343473241867"},"Windsor":{"minx":"-122.8778555653395","miny":"38.4773374562666","maxx":"-122.7585098113087","maxy":"38.59293019654574"},"Winters":{"minx":"-122.0081161283776","miny":"38.49392756299314","maxx":"-121.9327777589925","maxy":"38.56195137343861"},"Woodlake":{"minx":"-119.1528488974071","miny":"36.37289182310153","maxx":"-119.0627167057135","maxy":"36.44452280374112"},"Woodland":{"minx":"-121.8351098865219","miny":"38.6186868413379","maxx":"-121.6402775477857","maxy":"38.7277072465704"},"Woodside":{"minx":"-122.3271805032869","miny":"37.35497756443812","maxx":"-122.1984654927428","maxy":"37.4772755825867"},"Yorba Linda":{"minx":"-117.875408872382","miny":"33.83062844183434","maxx":"-117.6522004060925","maxy":"33.94635583278795"},"Yountville":{"minx":"-122.3903892255453","miny":"38.36670028313429","maxx":"-122.3384486857601","maxy":"38.42525532503856"},"Yreka":{"minx":"-122.6857216112262","miny":"41.67021220615899","maxx":"-122.5536180764659","maxy":"41.78444080005146"},"Yuba City":{"minx":"-121.726374441116","miny":"39.06501613562197","maxx":"-121.5736681205511","maxy":"39.20780656082094"},"Yucaipa":{"minx":"-117.1615165890678","miny":"33.97091762303673","maxx":"-116.9366810481283","maxy":"34.10660599441257"},"Yucca Valley":{"minx":"-116.5181226840492","miny":"34.07339251567979","maxx":"-116.3237556380799","maxy":"34.21870320177233"},"St. Helena":{"minx":"-122.5259526361669","miny":"38.47559699235568","maxx":"-122.4080941860488","maxy":"38.53818468040711"}};



// Function to populate the city selection dropdown
function populateCityDropdown() {
    var select = document.getElementById('citySelect');
    select.innerHTML = '<option value="">Select a city</option>'; // Clear existing options

    for (var cityName in cityBoundingBoxes) {
        var option = document.createElement('option');
        option.value = cityName;
        option.textContent = cityName;
        select.appendChild(option);
    }
}

// Call populateCityDropdown to populate the dropdown on page load
populateCityDropdown();


// Initialize the map
var map = L.map('map').setView([37.7749, -122.4194], 10);
var osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: ' OpenStreetMap contributors'
}).addTo(map);
var currentCityLayer = null;

// ... [Other Layers] ...
var wmsBaseEPUrl = geoserverUrl + '/EvacuationProjects/wms';

var checkedHPMSLayer = L.tileLayer.wms(wmsBaseEPUrl, {
    layers: 'EvacuationProjects:checked_HPMS_FULL_CA_2020_full',
    format: 'image/png',
    transparent: true,
    version: '1.1.0',
    crs: L.CRS.EPSG4326,
	opacity: 0.75 // Set the opacity to 75%
});

var nriCensusTractsLayer = L.tileLayer.wms(wmsBaseEPUrl, {
    layers: 'EvacuationProjects:CA_NRI_FEMA_2023',
    format: 'image/png',
    transparent: true,
    version: '1.1.0',
    crs: L.CRS.EPSG3857,
	opacity: 0.75 // Set the opacity to 75%
});

var fhszsLayer = L.tileLayer.wms(wmsBaseEPUrl, {
    layers: 'EvacuationProjects:fhszs06_3',
    format: 'image/png',
    transparent: true,
    version: '1.1.0',
    crs: L.CRS.EPSG4326,
    opacity: 0.5 // Set the opacity to 50%
});

var nlcdLandCoverLayer = L.tileLayer.wms(wmsBaseEPUrl, {
    layers: 'EvacuationProjects:CA_nlcd_2021_land_cover_l48_20230630_3857_proj_tiled',
    format: 'image/png',
    transparent: true,
    version: '1.1.0',
    crs: L.CRS.EPSG3857, // Assuming the layer is in EPSG:3857 projection
    opacity: 0.75 // Adjust the opacity as needed
});

// Define the WUI layer with the specified URL
var wuiLayer = L.esri.featureLayer({
    url: 'https://services1.arcgis.com/pf6KDbd8NVL1IUHa/arcgis/rest/services/Wildland_Urban_Interface_vector/FeatureServer/1',
    style: function (feature) {
        // Set the polygon fill color to orange
        return {
            fillColor: 'orange',
            weight: 2,
            opacity: 1,
            color: 'white',
            fillOpacity: 0.7
        };
    }
});

var baseLayers = {
    "OpenStreetMap": osmLayer
};

// Function to determine the color based on the score
function getColor(score) {
    return score > 90 ? 'red' :
           score > 80 ? '#FF4500' : // orangered
           score > 70 ? '#FFA500' : // orange
           score > 60 ? '#FFD700' : // gold
           score > 50 ? 'yellow' :
           score > 40 ? '#9ACD32' : // yellowgreen
           score > 30 ? '#ADFF2F' : // greenyellow
           score > 20 ? '#7FFF00' : // chartreuse
           score > 10 ? '#00FF00' : // lime
                     'green';
}

// Function to style the features
function style(feature) {
    return {
        fillColor: getColor(feature.properties.CIscoreP),
        weight: 2,
        opacity: 1,
        color: 'white',  // Border color
        fillOpacity: 0.7
    };
}

// Create the CalEnviroScreen 4.0 Results layer with the style function
var calEnviroScreenResultsLayer = L.esri.featureLayer({
    url: 'https://services1.arcgis.com/PCHfdHz4GlDNAhBb/ArcGIS/rest/services/CalEnviroScreen_4_0_Results_/FeatureServer/0',
    style: style,
    useCors: true
});

var overlayLayers = {
    "NRI Census Tracts": nriCensusTractsLayer,
    "HPMS Layer": checkedHPMSLayer,
    "FHSZS Layer": fhszsLayer,
    "NLCD Land Cover": nlcdLandCoverLayer,
    "CalEnviroScreen 4.0 Results": calEnviroScreenResultsLayer,
	"Wildland Urban Interface":wuiLayer
};



// Include the HPMS layer on map initialization
checkedHPMSLayer.addTo(map);

L.control.layers(baseLayers, overlayLayers).addTo(map);

// Update the city layer based on the dropdown selection
function updateCityLayer(cityName) {
    // Remove the current city layer if it exists
    if (currentCityLayer) {
        map.removeLayer(currentCityLayer);
    }

    // Check if a city has been selected
    if (cityName) {
        // Configure the CQL filter to match the selected city
        var cqlFilter = "CITY='" + cityName + "'"; // Ensure this matches the attribute in your shapefile

        // Add the new city layer with CQL_FILTER
        currentCityLayer = L.tileLayer.wms(wmsBaseEPUrl, {
            layers: 'EvacuationProjects:City_Boundaries',
            format: 'image/png', // Using image format for WMS
            transparent: true,
            version: '1.1.0',
            styles: '', // Specify if you have a particular style
            CQL_FILTER: cqlFilter // Apply the filter to only show the selected city
        }).addTo(map);

        // Bring the city layer to the front
        currentCityLayer.bringToFront();
    }

    // Use the bounding box from the old layer's information to zoom to the selected city
    if (cityName && cityBoundingBoxes[cityName]) {
        var bbox = cityBoundingBoxes[cityName];
        var bounds = [[bbox.miny, bbox.minx], [bbox.maxy, bbox.maxx]];
        map.fitBounds(bounds);
    }
}

const hazardAttributeMappings = {
    'ALL': 'ALL_vj',
    'AVLN': 'AVL_vj', // Shortened from 'AVLN' to 'AVL'
    'CFLD': 'CFL_vj',
    'CWAV': 'CWA_vj', // Assuming consistency in three-letter abbreviation
    'DRGT': 'DRG_vj',
    'ERQK': 'ERQ_vj',
    'HAIL': 'HAI_vj',
    'HWAV': 'HWA_vj',
    'HRCN': 'HRC_vj', // Assuming consistency in three-letter abbreviation if needed
    'ISTM': 'IST_vj', // Shortened from 'ISTM' to 'IST'
    'LNDS': 'LND_vj',
    'LTNG': 'LTN_vj',
    'RFLD': 'RFL_vj',
    'SWND': 'SWN_vj',
    'TRND': 'TRN_vj',
    'TSUN': 'TSU_vj',
    'VLCN': 'VLC_vj', // Shortened from 'VLCN' to 'VLC'
    'WFIR': 'WFI_vj',
    'WNTW': 'WNT_vj',
};


// Update node layer with all data
// Update the city nodes layer based on the dropdown selection
function updateCityNodes(cityName, selectedHazardType) {    // Assuming currentNodeLayer is globally defined to keep track of the current nodes layer
    if (currentNodeLayer) {
        map.removeLayer(currentNodeLayer); // Remove the current nodes layer if it exists
    }

    // Check if a city has been selected
    if (cityName && selectedHazardType) {
        // Construct the layer name for nodes using the city name
        var nodesLayerName = cityName.replace(/ /g, "_") + '_all_data'; // Formatting to match GeoServer naming convention
        var attributeName = hazardAttributeMappings[selectedHazardType]; // Get the attribute name based on the selected hazard type
        // Add the new city nodes layer
        currentNodeLayer = L.tileLayer.wms(wmsBaseEPUrl, {
            layers: 'EvacuationProjects:' + nodesLayerName,
            format: 'image/png', // Using image format for WMS
            transparent: true,
            version: '1.1.0',
            styles: 'generic_vj_style', // Use the generic style
            env: 'attribute:' + attributeName // Tell GeoServer which attribute to apply the style to
        }).addTo(map);

        // Optionally, bring the nodes layer to the front
        currentNodeLayer.bringToFront();
    }
}

// Ensure currentNodeLayer is defined outside of the function for global scope
var currentNodeLayer = null;


// Function to handle GetFeatureInfo requests
function getFeatureInfo(e) {
    var latlng = e.latlng;
    var point = map.latLngToContainerPoint(latlng); // Convert to pixel coordinates
    var BBOX = map.getBounds().toBBoxString();
    var WIDTH = map.getSize().x;
    var HEIGHT = map.getSize().y;
    var X = point.x;
    var Y = point.y;

    var URL = nriCensusTractsLayer._url +
        '?REQUEST=GetFeatureInfo&SERVICE=WMS&VERSION=1.1.1&' +
        'LAYERS=' + nriCensusTractsLayer.wmsParams.layers + '&' +
        'QUERY_LAYERS=' + nriCensusTractsLayer.wmsParams.layers + '&' +
        'BBOX=' + BBOX + '&FEATURE_COUNT=1&HEIGHT=' + HEIGHT + '&' +
        'WIDTH=' + WIDTH + '&INFO_FORMAT=text/html&' +
        'SRS=EPSG:4326&X=' + X + '&Y=' + Y;

    // Fetch the GetFeatureInfo response and display it in a popup
    fetch(URL)
        .then(function(response) { return response.text(); })
        .then(function(html) {
            if (html) {
                var parser = new DOMParser();
                var doc = parser.parseFromString(html, 'text/html');
                var rows = doc.querySelectorAll('table.featureInfo tr');

                for (var i = 1; i < rows.length; i++) {
                    var cells = rows[i].querySelectorAll('td');
                    var county = cells[5].textContent;
                    var population = cells[11].textContent;
                    var tract = cells[9].textContent;

                    var infoContent = '<div class="nri-popup">';
					infoContent += '<h2>FEMA NRI</h2>'; // Changed title
					infoContent += '<ul>';
					infoContent += '<li><strong>County:</strong> <em>' + county + '</em></li>'; // Italicize values
					infoContent += '<li><strong>Population:</strong> <em>' + population + '</em></li>';
					infoContent += '<li><strong>Census Tract ID:</strong> <em>' + tract + '</em></li>';
					infoContent += '</ul></div>';

                    L.popup()
                        .setLatLng(e.latlng)
                        .setContent(infoContent)
                        .openOn(map);
                }
            }
        });
}



function loadHazards() {
    const hazardSelect = document.getElementById('hazardSelect');
    const hazardMappings = {
    'ALL': 'All',
    'AVLN': 'Avalanche',
    'CFLD': 'Coastal Flooding',
    'CWAV': 'Cold Wave',
    'DRGT': 'Drought',
    'ERQK': 'Earthquake',
    'HAIL': 'Hail',
    'HWAV': 'Heat Wave',
    'HRCN': 'Hurricane',
    'ISTM': 'Ice Storm',
    'LNDS': 'Landslide',
    'LTNG': 'Lightning',
    'RFLD': 'Riverine Flooding',
    'SWND': 'Strong Wind',
    'TRND': 'Tornado',
    'TSUN': 'Tsunami',
    'VLCN': 'Volcanic Activity',
    'WFIR': 'Wildfire',
    'WNTW': 'Winter Weather'
};

    for (let code in hazardMappings) {
        let option = document.createElement('option');
        option.value = code;
        option.textContent = hazardMappings[code];
        hazardSelect.appendChild(option);
    }
}

loadHazards();

// Add a click event listener to the map for the GetFeatureInfo functionality
map.on('click', getFeatureInfo);

// Event listener for the city dropdown change
// Event listener for the city dropdown change
document.getElementById('citySelect').addEventListener('change', function() {
    var selectedCityName = this.value;
    var bbox = cityBoundingBoxes[selectedCityName];
    if (bbox) {
        updateCityLabel(selectedCityName, bbox); // Assuming this updates some UI element with the city name and bbox
        updateCityLayer(selectedCityName); // Update polygon layer
        updateCityNodes(selectedCityName); // Update nodes layer
    }
});


function imageErrorHandler(imgElement) {
    imgElement.onerror = null; // Prevent infinite fallback loop
    imgElement.src = '/static/images/no_image_available.png'; // Path to a default image
    // If you prefer to display text instead of a default image, you can modify the DOM, for example:
    // imgElement.style.display = 'none'; // Hide the image element
    // var container = imgElement.parentElement;
    // var errorMessage = document.createElement('div');
    // errorMessage.textContent = 'Image currently unavailable';
    // container.appendChild(errorMessage);
}


function updateHazardImage() {
    const citySelect = document.getElementById('citySelect');
    const hazardSelect = document.getElementById('hazardSelect');
    const hazardImage = document.getElementById('hazardImage');
    const imageTypeRadios = document.getElementsByName('imageType');

    let selectedCity = citySelect.value;
    let selectedHazard = hazardSelect.value;
    let selectedImageType = Array.from(imageTypeRadios).find(radio => radio.checked)?.value;

    if (selectedCity && selectedHazard && selectedImageType) {
        selectedCity = selectedCity.replace(/ /g, '_'); // Replace spaces with underscores in city names

        // Construct the file path based on the directory structure and selected image type
        const filePath = `/static/Sample/${selectedHazard}_/Figures_2/${selectedCity}_regions_${selectedImageType}.png`;

        hazardImage.src = filePath;
        hazardImage.alt = `${selectedCity} - ${selectedHazard}`;
        hazardImage.onerror = function() {
            imageErrorHandler(this);
        };
    } else {
        hazardImage.src = '';
        hazardImage.alt = 'Hazard Image';
    }
}



document.addEventListener('DOMContentLoaded', function() {
    // Attach event listeners to the dropdowns
    document.getElementById('citySelect').addEventListener('change', updateHazardImage);
    document.getElementById('hazardSelect').addEventListener('change', updateHazardImage);

    // Select all radio buttons with the name 'imageType'
    const imageTypeRadios = document.querySelectorAll('input[name="imageType"]');

    // Iterate over each radio button and attach the event listener
    imageTypeRadios.forEach(radio => {
        radio.addEventListener('change', updateHazardImage);
    });

    // Set the NRI radio button to checked by default
    document.getElementById('nri').checked = true;

    // Call updateHazardImage on page load to set default image
    updateHazardImage();
});



var currentCityLabel = null;

function updateCityLabel(cityName, bbox) {
    if (currentCityLabel) {
        map.removeLayer(currentCityLabel); // Remove existing label if it exists
    }

    // Convert bbox values to numbers
    var miny = parseFloat(bbox.miny);
    var maxy = parseFloat(bbox.maxy);
    var minx = parseFloat(bbox.minx);
    var maxx = parseFloat(bbox.maxx);

    // Calculate the center of the bounding box
    var centerLat = (miny + maxy) / 2;
    var centerLng = (minx + maxx) / 2;

    // Log the calculated values
    console.log('Center Latitude:', centerLat);
    console.log('Center Longitude:', centerLng);

    // Check if the calculated center coordinates are valid
    if (!isFinite(centerLat) || !isFinite(centerLng)) {
        console.error("Invalid center coordinates for city:", cityName, centerLat, centerLng);
        return; // Exit the function if center coordinates are not valid
    }

    // Create a new label marker
    currentCityLabel = L.marker([centerLat, centerLng], {
        icon: L.divIcon({
            className: 'city-label',
            html: '<span style="color: white; text-shadow: 1px 1px 2px black;">' + cityName + '</span>',
            iconAnchor: [100, 20] // Adjust based on your label size
        })
    });

    currentCityLabel.addTo(map);
}


map.on('overlayadd', function() {
    if (currentCityLayer) {
        currentCityLayer.bringToFront();
    }
});

map.on('click', getFeatureInfo);




// Call populateCityDropdown to populate the dropdown on page load
populateCityDropdown();

// Set default city to Sacramento
var citySelect = document.getElementById('citySelect');
citySelect.value = 'Sacramento';
updateCityLayer('Sacramento');
updateCityNodes('Sacramento', 'WFIR');
// Call loadHazards to populate the hazard dropdown on page load
loadHazards();

// Set default hazard to Wildfire
var hazardSelect = document.getElementById('hazardSelect');
hazardSelect.value = 'WFIR';
updateHazardImage();

var highlightLayer; // Global variable to store the highlight layer
var highlightTimeout; // Variable to store the timeout ID
var timeoutDelay = 150;
// Function to highlight a feature
function highlightFeature(feature) {
    highlightLayer = L.geoJSON(feature, {
        style: {
            color: '#ffff00', // Yellow outline
            weight: 3,
            opacity: 1
        }
    }).addTo(map);
}


// Function to handle mouseover event on the map for NRI layer
function onMapMouseMove(e) {
    if (!map.hasLayer(nriCensusTractsLayer)) {
        return; // Do nothing if NRI layer is not active
    }

    if (highlightTimeout) {
        clearTimeout(highlightTimeout); // Clear any existing timeout
    }

    highlightTimeout = setTimeout(function() {
        var latlng = e.latlng;
        var point = map.latLngToContainerPoint(latlng);
        var BBOX = map.getBounds().toBBoxString();
        var WIDTH = map.getSize().x;
        var HEIGHT = map.getSize().y;
        var X = point.x;
        var Y = point.y;

        var URL = nriCensusTractsLayer._url +
            '?REQUEST=GetFeatureInfo&SERVICE=WMS&VERSION=1.1.1&' +
            'LAYERS=' + nriCensusTractsLayer.wmsParams.layers + '&' +
            'QUERY_LAYERS=' + nriCensusTractsLayer.wmsParams.layers + '&' +
            'BBOX=' + BBOX + '&FEATURE_COUNT=1&HEIGHT=' + HEIGHT + '&' +
            'WIDTH=' + WIDTH + '&INFO_FORMAT=application/json&' +
            'SRS=EPSG:4326&X=' + X + '&Y=' + Y;

        fetch(URL)
            .then(function(response) { return response.json(); })
            .then(function(data) {
                if (data.features && data.features.length > 0) {
                    if (highlightLayer) {
                        map.removeLayer(highlightLayer); // Remove existing highlight
                    }
                    highlightFeature(data.features[0]);
                }
            });
    }, timeoutDelay); // Delay of 2 seconds
}

// Function to clear highlight
function clearHighlight() {
    if (highlightLayer) {
        map.removeLayer(highlightLayer);
        highlightLayer = null;
    }
    if (highlightTimeout) {
        clearTimeout(highlightTimeout); // Clear any existing timeout
    }
}

function isMobileDevice() {
    return /Mobi|Android/i.test(navigator.userAgent);
}

if (!isMobileDevice()) {
    // Attach event listeners for highlighting features
    map.on('mousemove', onMapMouseMove);
    map.on('mouseout', clearHighlight);
    // Include any other related functionalities that you want to disable on mobile
}



document.addEventListener("DOMContentLoaded", function() {
    const resizer = document.querySelector(".resize-bar");
    const sidebar = document.querySelector(".sidebar");
    const mapContainer = document.querySelector(".map-container");
    const noSelectElements = document.querySelectorAll(".sidebar, .map-container, .hazard-image-container img");

    function disableSelect() {
        noSelectElements.forEach(el => {
            el.style.userSelect = "none";
            el.style.webkitUserSelect = "none"; // For Safari and Chrome
            el.style.MozUserSelect = "none"; // For Firefox
        });
    }

    function enableSelect() {
        noSelectElements.forEach(el => {
            el.style.userSelect = "";
            el.style.webkitUserSelect = "";
            el.style.MozUserSelect = "";
        });
    }

    resizer.addEventListener("mousedown", (event) => {
        disableSelect();
        document.addEventListener("mousemove", resize, false);
        document.addEventListener("mouseup", () => {
            enableSelect();
            document.removeEventListener("mousemove", resize, false);
        }, false);
    });

    function resize(e) {
        const newWidth = e.clientX - sidebar.getBoundingClientRect().left;
        sidebar.style.flexBasis = `${newWidth}px`;
    }
});


// Legends
// NLCD
var nlcdClasses = {
    "Open Water": [70, 107, 159],
    "Perennial Ice/Snow": [209, 222, 248],
    "Developed, Open Space": [222, 197, 197],
    "Developed, Low Intensity": [217, 146, 130],
    "Developed, Medium Intensity": [235, 0, 0],
    "Developed, High Intensity": [171, 0, 0],
    "Barren Land (Rock/Sand/Clay)": [179, 172, 159],
    "Deciduous Forest": [104, 171, 95],
    "Evergreen Forest": [28, 95, 44],
    "Mixed Forest": [181, 197, 143],
    "Shrub/Scrub": [204, 184, 121],
    "Grassland/Herbaceous": [223, 223, 194],
    "Pasture/Hay": [220, 217, 57],
    "Cultivated Crops": [171, 108, 40],
    "Woody Wetlands": [184, 217, 235],
    "Emergent Herbaceous Wetlands": [108, 159, 184]
    // Add more classes as needed
};

function createNlcdLegend() {
    var legend = L.control({ position: 'bottomright' });

    legend.onAdd = function (map) {
        var div = L.DomUtil.create('div', 'info legend nlcd-legend');
        div.innerHTML = '<strong>NLCD Land Cover</strong><br>';
        var col1 = '<div class="nlcd-col">';
        var col2 = '<div class="nlcd-col">';
        var keys = Object.keys(nlcdClasses);
        var halfway = Math.ceil(keys.length / 2);

        keys.forEach(function(key, index) {
            var color = `rgb(${nlcdClasses[key].join(',')})`;
            var item = `<i style="background:${color};"></i> ${key}<br>`;
            if (index < halfway) {
                col1 += item;
            } else {
                col2 += item;
            }
        });

        col1 += '</div>';
        col2 += '</div>';
        div.innerHTML += col1 + col2;

        return div;
    };

    return legend;
}

// Assuming 'map' is your Leaflet map object
var nlcdLegend = createNlcdLegend();
//nlcdLegend.addTo(map);  // Add the legend to the map

// Assuming 'map' is your Leaflet map object and 'nlcdLandCoverLayer' is the NLCD layer

map.on('overlayadd', function(eventLayer) {
    if (eventLayer.name === 'NLCD Land Cover') {
        nlcdLegend.addTo(map);
    }
});

map.on('overlayremove', function(eventLayer) {
    if (eventLayer.name === 'NLCD Land Cover') {
        nlcdLegend.remove();
    }
});

// Create a Legend for FHSZ symbolized by Hazard Class
function createFHSZLegend() {
    var legend = L.control({ position: 'bottomright' });

    legend.onAdd = function (map) {
        var div = L.DomUtil.create('div', 'info legend');
        var grades = ['Moderate', 'High', 'Very High'];
        var colors = ['#FFFF00', '#FFA500', '#FF0000']; // Yellow, Orange, Red
        var labels = [];

        div.innerHTML = '<strong>CalFire FHSZ Legend</strong><br>';

        for (var i = 0; i < grades.length; i++) {
            labels.push(
                '<i style="background:' + colors[i] + '"></i> ' + grades[i]
            );
        }

        div.innerHTML += labels.join('<br>');
        return div;
    };

    return legend;
}

var legend = createFHSZLegend();

// Assuming 'map' is your Leaflet map object and 'fhszsLayer' is the CalFire FHSZ layer

map.on('overlayadd', function(eventLayer) {
    if (eventLayer.name === 'FHSZS Layer') { // Check if the added layer is FHSZS Layer
        legend.addTo(map);
    }
});

map.on('overlayremove', function(eventLayer) {
    if (eventLayer.name === 'FHSZS Layer') { // Check if the removed layer is FHSZS Layer
        legend.remove();
    }
});

// Add CalEnviroScreen legend
// Create a Legend for CalEnviroScreen
function createCalEnviroScreenLegend() {
    var legend = L.control({ position: 'bottomright' });

    legend.onAdd = function (map) {
        var div = L.DomUtil.create('div', 'info legend');
        // Define grades in descending order, excluding the upper bound
        var grades = [90, 80, 70, 60, 50, 40, 30, 20, 10, 0];
        var labels = [];

        div.innerHTML = '<strong>CalEnviroScreen Scores</strong><br>';

        for (var i = 0; i < grades.length; i++) {
            var from = grades[i];
            var to = (i === 0) ? 100 : grades[i - 1] - 1;

            var color = getColor(from);
            labels.push('<i style="background:' + color + '"></i> ' + from + '&ndash;' + to);
        }

        div.innerHTML += labels.join('<br>');
        return div;
    };

    return legend;
}

var calEnviroScreenLegend = createCalEnviroScreenLegend();



// Assuming 'map' is your Leaflet map object and 'calEnviroScreenResultsLayer' is the CalEnviroScreen layer
map.on('overlayadd', function(eventLayer) {
    if (eventLayer.name === 'CalEnviroScreen 4.0 Results') {
        calEnviroScreenLegend.addTo(map);
    }
});

map.on('overlayremove', function(eventLayer) {
    if (eventLayer.name === 'CalEnviroScreen 4.0 Results') {
        calEnviroScreenLegend.remove();
    }
});

// Define the legend control for WUI layer
var wuiLegend = L.control({ position: 'bottomright' });

// Function to generate the WUI legend HTML content
wuiLegend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'info legend');
    div.innerHTML = '<strong>Wildland Urban Interface</strong><br>';
    // Add legend content specific to WUI layer (e.g., color codes, labels)
    div.innerHTML += '<i style="background: orange;"></i> WUI Polygons<br>';
    return div;
};

// Assuming 'map' is your Leaflet map object and 'wuiLayer' is the WUI layer
map.on('overlayadd', function(eventLayer) {
    if (eventLayer.name === 'Wildland Urban Interface') {
        wuiLegend.addTo(map); // Add the WUI legend when the layer is checked
    }
});

map.on('overlayremove', function(eventLayer) {
    if (eventLayer.name === 'Wildland Urban Interface') {
        wuiLegend.remove(); // Remove the WUI legend when the layer is unchecked
    }
});

